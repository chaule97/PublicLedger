import sys, os
from PyQt6.QtWidgets import QApplication
from views.home import Home
from utils.get_icon import iconFromBase64
from db import database, DB_PATH
from peewee_migrate import Router


icon_base64 = b'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AH8AAAC4AAAA+wAAAFUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADoAAACnAAAAyAAAAKUAAAA1AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA///////+P///+A///+AD/+ODwf/gD/B/8B/4P/x4Bg//wAGH/8Hwwf//wDB//AAYD/AABAPhAADAA8AA8AfgD//4D///8Af///EH///zI///8yP///Ih///xAP//+AR///gEf///BH///wR///+A////wf////////////////8='


def init_db():
    # Nếu DB chưa có file thì tạo file rỗng
    if not os.path.exists(DB_PATH):
        open(DB_PATH, "w").close()

    database.connect()
    router = Router(database, migrate_dir=os.path.join(os.path.dirname(__file__), "migrations"))
    router.run()  # chạy toàn bộ migrations
    database.close()

def main():
    init_db()
    app = QApplication(sys.argv)
    icon = iconFromBase64(icon_base64)
    app.setWindowIcon(icon)
    x = Home()
    sys.exit(app.exec())


if __name__ == '__main__':
    main()